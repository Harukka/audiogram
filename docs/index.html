    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
       

        <title>Audiogram</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
        <!-- <style>
            #chart {max-width:640px;max-height:480px;}
        </style> -->
    </head>
    <body>
        <div class="container-fluid">
            <div class="row">
                <p>
                    Hearing Test Result
                </p>
            </div>
            <table class="table">
            <caption>CAPTION</caption>
                <thead>
                    <tr>
                        <th scope="col"></th>
                        <th scope="col">125</th>
                        <th scope="col">250</th>
                        <th scope="col">500</th>
                        <th scope="col">750</th>
                        <th scope="col">1000</th>
                        <th scope="col">1500</th>
                        <th scope="col">2000</th>
                        <th scope="col">3000</th>
                        <th scope="col">4000</th>
                        <th scope="col">6000</th>
                        <th scope="col">8000</th>
                    </tr>
                </thead>
                <tr>
                    <th scope="row">RIGHT</th>
                    <td>
                        <select name="db1" id="db1" ></select>
                    </td>
                    <td>
                        <select name="db2" id="db2" ></select>
                    </td>
                    <td>
                        <select name="db3" id="db3" ></select>
                    </td>
                    <td>
                        <select name="db4" id="db4" ></select>
                    </td>
                    <td>
                        <select name="db5" id="db5" ></select>
                    </td>
                    <td>
                        <select name="db6" id="db6" ></select>
                    </td>
                    <td>
                        <select name="db7" id="db7" ></select>
                    </td>
                    <td>
                        <select name="db8" id="db8" ></select>
                    </td>
                    <td>
                        <select name="db9" id="db9" ></select>
                    </td>
                    <td>
                        <select name="db10" id="db10" ></select>
                    </td>
                    <td>
                        <select name="db11" id="db11" ></select>
                    </td>
                </tr>
                <tr>
                    <th scope="row">LEFT</th>
                    <td>
                        <select name="db12" id="db12" ></select>
                    </td>
                    <td>
                        <select name="db13" id="db13" ></select>
                    </td>
                    <td>
                        <select name="db14" id="db14" ></select>
                    </td>
                    <td>
                        <select name="db15" id="db15" ></select>
                    </td>
                    <td>
                        <select name="db16" id="db16" ></select>
                    </td>
                    <td>
                        <select name="db17" id="db17" ></select>
                    </td>
                    <td>
                        <select name="db18" id="db18" ></select>
                    </td>
                    <td>
                        <select name="db19" id="db19" ></select>
                    </td>
                    <td>
                        <select name="db20" id="db20" ></select>
                    </td>
                    <td>
                        <select name="db21" id="db21" ></select>
                    </td>
                    <td>
                        <select name="db22" id="db22" ></select>
                    </td>
                </tr>
            </table>
            <!-- updateBtn -->
            <input type="button" value="Update" id="updateBtn" />
        
        </div>
        <div>
            <canvas id="chart" width="300" height="400"></canvas>
        </div>

    </body>

    <script>
        //dB
        for ( let j = 1; j <= 22; j++){
            let id = document.getElementById("db" + j);
            let none = document.createElement("option");
            none.innerHTML = "-";
            id.appendChild(none);

            for (let i = -10; i <= 120; i=i+5){
                let option = document.createElement("option");
                // option.innerHTML = i + "dB";
                option.innerHTML = i;
                id.appendChild(option);
            }   
        }
        //get selected dB
        function btnClick(){
            updateChart();
        }
        var updateBtn = document.getElementById("updateBtn");
        updateBtn.addEventListener("click", btnClick);

        //Chart
        var ctx = document.getElementById('chart');

        var data = {
            labels: ["125", "250", "500", "750", "1000", "1500", "2000", "3000", "4000", "6000","8000"],
            datasets: [
                {
                label: 'Right',
                data: [],
                borderColor: 'rgba(255, 100, 100, 1)',
                //If true, lines will be drawn between points with no or null data.
                spanGaps: true,
                pointStyle: 'circle',
                pointRadius: 10,
                pointHoverRadius: 15,
                },
                {
                label: 'Left',
                data: [],
                borderColor: 'rgba(15, 10, 222, 1)',
                spanGaps: true,
                pointStyle: 'crossRot',
                pointRadius: 10,
                pointHoverRadius: 15,
                }
            ]
        };

        var options = {};

        var audiogramChart = new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                layout: {
                    padding: 50
                },
               scales: {
                    x: {
                        title:{
                            display: true,
                            text: '周波数(Hz)'
                        }                        
                    },
                    y: {
                        title: {
                            display: true,
                            text: '聴力レベル(dB)'
                        },
                        //top 0 -> bottom 120
                        reverse: true,
                        min: -10,
                        max: 120,
                        ticks: {
                            stepSize: 10,
                        }
                    },
                }
            }
        });
        
        function updateChart(){
            let rightEarData = [];
            let leftEarData = [];

            for(let j = 1; j <=11; j++){
                let rightEarInputs = document.getElementById("db"+ j);
                let idx = rightEarInputs.selectedIndex; 
                rightEarData.push(rightEarInputs[idx].text);
            }

            for(let j = 12; j <=22; j++){
                let leftEarInputs = document.getElementById("db"+ j);
                let idx = leftEarInputs.selectedIndex;
                leftEarData.push(leftEarInputs[idx].text);
                }
                console.log(leftEarData);

                audiogramChart.data.datasets[0].data = rightEarData;
                audiogramChart.data.datasets[1].data = leftEarData;
                audiogramChart.update();
        }


    </script>
    </html>